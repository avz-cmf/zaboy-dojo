{% extends '@layout/rqlExample.html.twig' %}

{% block main %}
{% endblock main %}

{% block script %}
    <script>
        function ready() {

            // 1. Создаём новый объект XMLHttpRequest
            var xhr = new XMLHttpRequest();

            // 2. Задаем URL нашего хранилища
            var url = 'http://localhost:8080/api/v1/rest/users';

            // 3. Задаем rql строку запроса.
            var rql = 'limit(10)';

            // 4. Конфигурируем его: GET-запрос на URL 'http://localhost:8080/api/v1/rest/users' + наш Rql '' запрос
            // (Убираем асинхронность запроса для простоты примера)
            xhr.open('GET', url + '?' + rql, false);

            // 5. Отсылаем запрос
            xhr.send();

            // 6. Если код ответа сервера не 200, то это ошибка
            if (xhr.status != 200) {
                // обработать ошибку
                alert( xhr.status + ': ' + xhr.statusText ); // пример вывода: 404: Not Found
            } else {
                // вывести результат
                alert( xhr.responseText ); // responseText -- текст ответа.
            }
        }

        //Запустим функцию ready когда страница будет загружена
        document.addEventListener("DOMContentLoaded", ready);
    </script>
{% endblock script %}